- type: construction
  id: GrenadeTurret
  name: grenade turret
  description: An automated grenade turret. It fires high explosive grenades that do immense damage to organic targets, but it's underwhelming against armor. The turret's lack of friendly fire systems also causes it to have a high rate of killing its builders.
  graph: ColonyTurret
  startNode: start
  targetNode: grenade_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: construction
  id: SniperTurret
  name: sniper turret
  description: An automated sniper turret. Hard hitting and long range, but lacking in fire rate. It doesn't care about friendly fire, so watch its line of fire.
  graph: ColonyTurret
  startNode: start
  targetNode: sniper_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: construction
  id: ShotgunTurret
  name: shotgun turret
  description: An automated shotgun turret. Hard hitting and short range, but ineffective against armor. It doesn't care about friendly fire, so watch its line of fire.
  graph: ColonyTurret
  startNode: start
  targetNode: shotgun_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: construction
  id: MinigunTurret
  name: machine gun turret
  description: An automated machine gun turret. Its high fire rate excels in suppression , but its low damage is useless against armor. It doesn't care about friendly fire, so watch its line of fire.
  graph: ColonyTurret
  startNode: start
  targetNode: minigun_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: construction
  id: IncendiaryTurret
  name: incendiary turret
  description: An automated incendiary turret. It fires slugs that ignite on contact with organic material. It doesn't care about friendly fire, so watch its line of fire.
  graph: ColonyTurret
  startNode: start
  targetNode: incendiary_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: construction
  id: DisablerTurret
  name: disabler turret
  description: An automated disabler turret. It stuns even armored targets very effectively. It doesn't care about friendly fire, so watch its line of fire.
  graph: ColonyTurret
  startNode: start
  targetNode: disabler_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: construction
  id: LaserTurret
  name: light laser turret
  description: An automated laser turret. Simple, effective, and reliable. It doesn't care about friendly fire, so watch its line of fire.
  graph: ColonyTurret
  startNode: start
  targetNode: laser_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: construction
  id: HeavyLaserTurret
  name: heavy laser turret
  description: An automated heavy laser turret. Its beams do more damage, at the cost of firing slowly. It doesn't care about friendly fire, so watch its line of fire.
  graph: ColonyTurret
  startNode: start
  targetNode: heavy_laser_turret
  category: Defense
  icon:
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    state: syndie_lethal
  objectType: Structure
  placementMode: SnapgridCenter
  canRotate: false
  conditions:
  - !type:TileNotBlocked

- type: constructionGraph
  id: ColonyTurret
  start: start
  graph:
  - node: start
    edges:
    - to: frame
      steps:
      - material: Steel
        amount: 3
        doAfter: 1
      - material: Cable
        amount: 1
        doAfter: 1

  - node: frame
    entity: TurretFrame
    edges:
    - to: grenade_turret
      steps:
      - material: Plasteel
        amount: 4
        doAfter: 1.5
      - material: Plasma
        amount: 6
        doAfter: 3
      - tag: GrenadeTurretBoard
        name: grenade turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticGrenadeNanoTrasen
      - !type:DeleteEntity
  
    - to: sniper_turret
      steps:
      - material: Plasteel
        amount: 1
        doAfter: 0.5
      - tag: SniperTurretBoard
        name: sniper turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticSniperNanoTrasen
      - !type:DeleteEntity

    - to: shotgun_turret
      steps:
      - material: Steel
        amount: 1
        doAfter: 0.5
      - tag: ShotgunTurretBoard
        name: shotgun turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticShotgunNanoTrasen
      - !type:DeleteEntity

    - to: minigun_turret
      steps:
      - material: Steel
        amount: 2
        doAfter: 1
      - tag: MinigunTurretBoard
        name: machine gun turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticMinigunNanoTrasen
      - !type:DeleteEntity

    - to: incendiary_turret
      steps:
      - material: Plasma
        amount: 5
        doAfter: 4
      - tag: IncendiaryTurretBoard
        name: incendiary turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticIncendiaryNanotrasen
      - !type:DeleteEntity

    - to: disabler_turret
      steps:
      - material: Glass
        amount: 1
        doAfter: 0.5
      - tag: DisablerTurretBoard
        name: disabler turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticDisablerNanoTrasen
      - !type:DeleteEntity

    - to: laser_turret
      steps:
      - material: Glass
        amount: 2
        doAfter: 1
      - tag: TurretBoardLaser
        name: laser turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticLaserNanoTrasen
      - !type:DeleteEntity

    - to: heavy_laser_turret
      steps:
      - material: Glass
        amount: 3
        doAfter: 1.5
      - tag: TurretBoardHeavyLaser
        name: heavy laser turret board
        icon:
          sprite: Objects/Misc/module.rsi
          state: security
        doAfter: 3
      - tool: Screwing
        doAfter: 2
      completed:
      - !type:SpawnPrototype
        prototype: WeaponTurretStaticHeavyLaserNanoTrasen
      - !type:DeleteEntity

  - node: grenade_turret
    entity: TurretFrame

  - node: sniper_turret
    entity: TurretFrame
  
  - node: shotgun_turret
    entity: TurretFrame
  
  - node: minigun_turret
    entity: TurretFrame
  
  - node: incendiary_turret
    entity: TurretFrame
  
  - node: disabler_turret
    entity: TurretFrame
  
  - node: laser_turret
    entity: TurretFrame
  
  - node: heavy_laser_turret
    entity: TurretFrame

- type: entity
  parent: BaseStructure
  id: TurretFrame
  name: turret frame
  description: An automated turret, under construction.
  components:
  - type: Construction
    graph: ColonyTurret
    node: frame
  - type: Damageable
    damageContainer: Inorganic
  - type: Destructible
    thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 300
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
      - trigger:
          !type:DamageTrigger
          damage: 100
        behaviors:
          - !type:DoActsBehavior
            acts: [ "Destruction" ]
          - !type:PlaySoundBehavior
            sound:
              collection: MetalGlassBreak
          - !type:SpawnEntitiesBehavior
            spawn:
              SheetSteel1:
                min: 1
                max: 3
              CableApcStack1:
                min: 1
                max: 1
  - type: Sprite
    sprite: Objects/Weapons/Guns/Turrets/turrets.rsi
    drawdepth: Mobs
    layers:
      - state: syndie_lethal